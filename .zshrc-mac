# Fig pre block. Keep at the top of this file.
[[ -f "$HOME/.fig/shell/zshrc.pre.zsh" ]] && builtin source "$HOME/.fig/shell/zshrc.pre.zsh"

# ==============================================================================
# Z Shell and Oh My ZSH
# ==============================================================================

# Variables
export TERM=xterm-256color
export EDITOR=lvim

# Path to your oh-my-zsh installation.
export ZSH="$HOME/.oh-my-zsh"

export ZSH_THEME="crcandy"
precmd() {
  print ""
}

# Plugins
export plugins=(git npm brew composer copyfile copypath colored-man-pages branch)

source "$ZSH"/oh-my-zsh.sh

# --------------------
# Path
# --------------------

export PATH="$HOME/bin:$PATH"
export PATH="$HOME/.composer/vendor/bin:$PATH"
export PATH="$HOME/.cargo/bin:$PATH"
export PATH="$HOME/.local/bin:$PATH"
. "$HOME"/Projects/Me/dotfiles/z.sh

export PATH="/usr/local/bin:$PATH"
export PATH="/opt/homebrew/opt/ruby/bin:$PATH"

# --------------------
# History
# --------------------

# Exclude commands from history
setopt INC_APPEND_HISTORY

git="git*|gss|gst|git"
editors="nano*|cat*|less*|bat*|man*"
shell="env*|exit|alias*"
filesystem="z*|ls*|ols*|mv*|cp*|rm*|cd*|take*|mkcd*|fd*|broot*|d|1|2|3|4|5|6|7|8|9|0"
composer="cdo|cdu|cgr|cgrm*|cgu*|ci|co|cod|codg|cog|cr*|crm*|cs*|csg*|csu|cu*|cug*|composer*"
php="php*|a *|pecl *|duster*|phpcs*|pu*|puf*|puu*|vendor/bin/phpunit*|xd*"
java="java*|jar*|gradle*"
laravel="valet*|lambo*"
development="npm*"
export HISTORY_IGNORE="${composer} \
|${git} \
|${filesystem} \
|${php} \
|${java} \
|${editors} \
|${shell} \
|${development} \
|${laravel}"

# --------------------
# Bind Keys
# --------------------

# Home
bindkey '^[[H' beginning-of-line
# End
bindkey '^[[F' end-of-line

# ==============================================================================
# Boot Tooling
# ==============================================================================

# fnm (Fast Node Manager)
# See, https://github.com/Schniz/fnm
eval "$(fnm env --use-on-cd)"

source "$HOME"/.config/broot/launcher/bash/br

# ==============================================================================
# Aliases
# ==============================================================================

# Remove conflicting aliases provided by Oh-My-Zsh
unalias lsa
unalias l

alias ls='lsd'
alias tree='broot'
alias nv='br --only-folders'
alias ip='curl http://ipecho.net/plain; echo'
alias edit:zshrc='$EDITOR ~/.zshrc'
alias env:find='env | fgrep'
alias clear:history='echo "" > ~/.zsh_history'

function alias:ls {
    alias | grep -F --color=never "$1" | awk '{FS = "="; printf("%-10s %s\n",$1,$2) }'
}

alias subl='/Applications/Sublime\ Text.app/Contents/SharedSupport/bin/subl'
alias code='/Applications/Visual\ Studio\ Code.app/Contents/Resources/app/bin/code'

if [[  "$TERM_PROGRAM" = "iTerm.app" && -e "${HOME}/.iterm2_shell_integration.zsh" ]]
then
  echo 'Loading iTerm shell integration for zsh'
  source "${HOME}/.iterm2_shell_integration.zsh"
fi

# Fix "" bug in Fig
unalias -- -

# Fig post block. Keep at the bottom of this file.
[[ -f "$HOME/.fig/shell/zshrc.post.zsh" ]] && builtin source "$HOME/.fig/shell/zshrc.post.zsh"